---
title: "Activity 4: Data visualization 2: Customizing plots"
subtitle: Jan. 14th, 2026, Calvin Munson
format: markdown_github
editor: visual
---

# Overview

Welcome! Today's activity is all about the basics of customizing plots. We will continue using `ggplot2` and will use two built-in datasets for this activity (no reading in data is necessary today!).

You will submit two outputs for this activity:

1.  A **PDF** of a rendered Quarto document with all of your R code (see below). Please include all of the code that appears in this document, in addition to adding your own code in the "Q#" sections.

2.  A plot and research question from the final section

A note about submitting code:

As a general practice, it is good to **use headers to denote which section of the homework** you are in and **add in your own comments about what each line is actually doing** - this is excellent practice for organizing your own big R scripts in the future. The biggest way that you will code for probably the first few years of your coding career will consist of you revisiting old R scripts and copying/pasting code and/or adapting that code to your current problems. I promise you, your future self will be thrilled with your current self if you take the extra few minutes to 1) organize your code in a nice way and 2) provide detailed comments about what each line is doing (as well as what questions you have about it).

Also, donâ€™t be afraid to use lots of blank lines! It is MUCH nicer for your future self to look at code that has a few blank lines in between sections of code than a bajillion lines in a row of straight code.

*From here on, please put headers (either as comments in the code or as Quarto headers) to denote which question you are answering (e.g. "Q1:") and precede your code with comments that describe what that code does.*

# 1) Penguins!

## Setting up

First, let's load our packages. You should already have the `here` and `ggplot2` packages installed; read them in from the library in your code. Also install and read in the `palmerpenguins` package, which contains built-in data - you may recognize this from Malin's ggplot lecture!

```{r setup, warning = FALSE, message = FALSE}
# install.packages("palmerpenguins")
library(ggplot2)
library(here)
library(palmerpenguins)


```

We just installed a package which has data built into it. We are going to go ahead and store the `penguins` data frame as a data object anyway (not technically necessary because it's already built-in, but this reinforces storing dataframes).

```{r}
# Read in the palmer penguins data
penguins <- penguins
```

Next, let's navigate to the help page of this dataset. Doing so provides information on the dataset and its various columns. We can learn that this dataset "includes measurements for penguin species, island in Palmer Archipelago, size (flipper length, body mass, bill dimensions), and sex". Read on to learn about each column in the dataset.

```{r}
# Putting a "?" in front of a function (or built-in dataset) will automatically bring up its help page!
?penguins
```

## Start with a question

Let's start by forming a research question. Let's ask: *How are bill length and bill depth associated, and how does this vary by species of penguin?*

Let's create a basic graph to begin. Plotting `bill_length_mm` on the x-axis and `bill_depth_mm` on the y-axis.

```{r}
ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
  geom_point()
```

### Q1.1: Do you see a relationship?

Does it look like there is a relationship between these variables? Describe the relationship.

------------------------------------------------------------------------

### Q1.2: Color the points by species of penguin

That previous graph only addresses part of our question: we asked not only "how are bill length and bill depth associated", but also "**how does this vary by species of penguin**?"

To address the second part of our question,

1.  Change the aesthetics of this plot to color the points by the species of penguin and

2.  Interpret the graph by describing if this changes your answer to the previous question.

```{r}

```

The take-home message here is to be thorough with how you look at your data! If you ignore certain variables, you might miss important patterns (this is also crucial when deciding what statistical models we should run on our data, but more on that in a few weeks!).

Ok, now let's jump into some fun data visualization and learn about how to customize our plots!

------------------------------------------------------------------------

## Scales for aesthetics

We can manually modify the values of the aesthetics of our ggplot graph (the `color`, `shape`, opacity aka `alpha`, etc) by using a series of functions called `scale_*_**()` where the first * is replaced by the aesthetic we are modifying (e.g. color), and the second translates to the kind of prepacked or manual set of values that we want to use. Often it will be `scale_*_manual()` if we want to manually chose the values instead of using premade ones. 

Monday's Seaside Chat provided some practice with modifying the scales of the color aesthetics using `scale_color_manual()` and `scale_color_brewer()`.

### Q1.3: Add your favorite colors to your graph

Using your new color skills, modify the `scale_color_*` code below to include a new color selection!

*Sidenote: When you're typing within a function, you can hit "Enter" (or "Return" for Mac users) after a comma to continue code on a new line - see how I made a new line within `geom_point(aes())`. This can make things look much neater if you have content for many arguments at once! It also does not affect how the code is run at all.*

```{r}
ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
  geom_point(aes(color = species)) +
  scale_color_brewer(palette = "Dark2")
```

Let's make the shape of the points vary by species to even more clearly separate the points by species:


```{r}
ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
  geom_point(aes(color = species,
                 shape = species)) +
  scale_color_brewer(palette = "Dark2")
```

If we want to manually change the shapes that ggplot supplies, we use `scale_shape_manual()`:


```{r}
ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
  geom_point(aes(color = species,
                 shape = species)) +
  scale_color_brewer(palette = "Dark2") +
  scale_shape_manual(values = c(8, 11, 14))
```

I personally like using shapes that have a black outline and are filled with the color, rather than being solid throughout. Change the manually selected shapes to 21, 22, and 24



```{r}
ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
  geom_point(aes(color = species,
                 shape = species)) +
  scale_color_brewer(palette = "Dark2") +
  scale_shape_manual(values = c(21, 22, 24))
```

Why aren't the shapes filled with the color we supply? Some shapes and geoms in R have both `color` and `fill` capabilities. When they have both, then anything you supply to `color` will color the outline of the shape, while anything supplied to `fill` will fill in the shape (as we want here).

To make this switch, we are going to change the `color = species` aesthetic to `fill = species` and instead of `scale_color_brewer()` we will use `scale_fill_brewer()`


```{r}
ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
  geom_point(aes(fill = species,
                 shape = species)) +
  scale_fill_brewer(palette = "Dark2") +
  scale_shape_manual(values = c(21, 22, 24))
```

At this point, I'd also like to make the size of the points a little bigger, but I don't want it to vary with something in the data. As in the last activity, to make an element of the geom vary statically across all of the data, put it *outside* of the `aes()` but still within the relevant geom:

```{r}
ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
  geom_point(aes(fill = species,
                 shape = species),
             size = 2.5) +
  scale_fill_brewer(palette = "Dark2") +
  scale_shape_manual(values = c(21, 22, 24))
```

## Scales for axis aesthetics specifically

Your x- and y- axes are part of your aesthetics, just like color, fill, shape. You can modify the scales of the axes too. Two common ways people change up the scales of their graphs are:  

1.    Changing the limits of their plots and
2.    Transforming axis values to log scales.

Let's modify the y-axis. It's a continuous variable, so we use `scale_y_continuous()`.

```{r}
ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
  geom_point(aes(fill = species,
                 shape = species),
             size = 2.5) +
  scale_fill_brewer(palette = "Dark2") +
  scale_shape_manual(values = c(21, 22, 24)) +
  scale_y_continuous(limits = c(0, 100))
```

## Labels

## Themes

# 2) CO2 Uptake in Grass Plants Data

Next, it's time to practice what you've learned again! R has a number of built-in datasets. The dataset `CO2` provides the data from an experiment on the cold tolerance of a grass species. Familiarize yourself with the dataset by reading the help page for this dataset

```{r}
# Putting a "?" in front of a function (or built-in dataset) will automatically bring up its help page!
?CO2
```

### Q2.1: Write a research question that you would like to answer

Once you have a sense of what is in the dataset, write a research question that you would like to answer. There are many options with varying complexity!

### Q2.2: Choose a graph to answer your question

What graph would be appropriate to answer this question? Think about the kinds of graphs we've used so far and whether your variables are continuous or categorical.

### Q2.3: Create your graph
